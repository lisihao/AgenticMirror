# Agentic Mirror - 硬件设计文档

> 版本: 1.0.0
> 日期: 2025-01-16

---

## 一、硬件系统概述

### 1.1 设计目标

| 目标 | 指标 |
|------|------|
| 人脸追踪精度 | <1度偏差 |
| 追踪延迟 | <100ms |
| 图像分辨率 | 4K@30fps |
| 皮肤分析精度 | 医疗级 (±5%) |
| 续航时间 | 支持持续使用 4小时+ |
| 噪音控制 | <25dB |

### 1.2 整机外观设计

```
                    ┌─────────────────────────────────┐
                    │          15.6" 显示屏           │
                    │         (镜面反射镀膜)          │
                    │                                 │
                    │    ┌─────────────────────┐     │
                    │    │                     │     │
                    │    │                     │     │
                    │    │    镜面显示区域     │     │
                    │    │                     │     │
                    │    │                     │     │
                    │    └─────────────────────┘     │
                    │                                 │
                    │  [LED补光环]       [摄像头模组] │
                    │       ○                 ●       │
                    └─────────────────┬───────────────┘
                                      │
                              ┌───────┴───────┐
                              │   云台底座    │
                              │    (可旋转)   │
                              └───────────────┘
                                      │
                              ┌───────┴───────┐
                              │    稳定底座   │
                              │   (配重设计)  │
                              └───────────────┘

尺寸: 380mm x 280mm x 120mm (含底座)
重量: 约 2.5kg
```

---

## 二、核心硬件模块

### 2.1 主控系统

#### 2.1.1 主芯片选型: Rockchip RK3588

| 参数 | 规格 |
|------|------|
| CPU | 4x Cortex-A76 @ 2.4GHz + 4x Cortex-A55 @ 1.8GHz |
| GPU | Mali-G610 MP4 |
| NPU | 6 TOPS AI 算力 |
| 内存 | 8GB LPDDR5 |
| 存储 | 64GB eMMC 5.1 + microSD 扩展 |
| 视频编码 | 8K@30fps H.265/H.264 |
| 视频解码 | 8K@60fps H.265 |

**选型理由:**
- 强大的 NPU 支持本地 AI 推理
- 多路摄像头输入 (MIPI CSI)
- 成熟的 Linux/Android 支持
- 成本相对可控

#### 2.1.2 系统框图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           RK3588 主控系统                                    │
└─────────────────────────────────────────────────────────────────────────────┘

                         ┌─────────────────────┐
                         │      RK3588         │
                         │                     │
  ┌──────────────────────┤  CPU + GPU + NPU   ├──────────────────────┐
  │                      │                     │                      │
  │                      └──────────┬──────────┘                      │
  │                                 │                                 │
  │         ┌───────────────────────┼───────────────────────┐        │
  │         │                       │                       │        │
  │         ▼                       ▼                       ▼        │
  │  ┌─────────────┐        ┌─────────────┐        ┌─────────────┐  │
  │  │ LPDDR5      │        │ eMMC 5.1    │        │ microSD     │  │
  │  │ 8GB         │        │ 64GB        │        │ Slot        │  │
  │  └─────────────┘        └─────────────┘        └─────────────┘  │
  │                                                                   │
  │  ┌─────────────────────────────────────────────────────────────┐ │
  │  │                        I/O 接口                              │ │
  │  │                                                              │ │
  │  │  MIPI CSI x4  │  MIPI DSI x2  │  USB 3.0 x2  │  PCIe 3.0   │ │
  │  │  (摄像头)     │  (显示屏)      │  (扩展)       │  (WiFi/BLE) │ │
  │  │                                                              │ │
  │  │  I2C x5       │  SPI x2       │  UART x10    │  GPIO x32   │ │
  │  │  (传感器)     │  (Flash)      │  (调试)       │  (控制)     │ │
  │  │                                                              │ │
  │  └─────────────────────────────────────────────────────────────┘ │
  │                                                                   │
  └───────────────────────────────────────────────────────────────────┘
```

### 2.2 摄像头模组

#### 2.2.1 RGB 主摄像头

| 参数 | 规格 |
|------|------|
| 传感器 | Sony IMX586 |
| 像素 | 48MP (支持 4K 输出) |
| 光圈 | f/1.8 |
| 对焦 | PDAF + CDAF |
| 视场角 | 80° |
| 帧率 | 4K@30fps, 1080P@60fps |
| 接口 | MIPI CSI-2 4Lane |

#### 2.2.2 红外摄像头 (皮肤深层分析)

| 参数 | 规格 |
|------|------|
| 传感器 | OmniVision OV7251 |
| 波长 | 850nm / 940nm 双通道 |
| 像素 | 640 x 480 |
| 帧率 | 120fps |
| 用途 | 皮下血管、色素检测 |
| 接口 | MIPI CSI-2 2Lane |

#### 2.2.3 ToF 深度传感器

| 参数 | 规格 |
|------|------|
| 型号 | Infineon REAL3 |
| 分辨率 | 352 x 288 |
| 测距范围 | 0.1m - 2m |
| 精度 | ±1cm |
| 帧率 | 60fps |
| 用途 | 3D 人脸建模、手势识别 |

#### 2.2.4 摄像头模组布局

```
        ┌─────────────────────────────────────────┐
        │              摄像头模组 PCB             │
        │                                         │
        │    ┌─────┐     ┌─────┐     ┌─────┐    │
        │    │ RGB │     │ ToF │     │ IR  │    │
        │    │ 48MP│     │     │     │ 850 │    │
        │    └─────┘     └─────┘     └─────┘    │
        │                                         │
        │    ┌─────┐              ┌─────────┐   │
        │    │ IR  │              │  ISP    │   │
        │    │ 940 │              │ (本地)  │   │
        │    └─────┘              └─────────┘   │
        │                                         │
        │    [MIPI CSI 连接器]                   │
        │                                         │
        └─────────────────────────────────────────┘
```

### 2.3 云台系统

#### 2.3.1 云台规格

| 参数 | 规格 |
|------|------|
| 类型 | 2轴 (俯仰 + 偏航) |
| 俯仰角度 | -15° ~ +30° |
| 偏航角度 | -45° ~ +45° |
| 转速 | 最大 60°/s |
| 定位精度 | 0.1° |
| 电机类型 | 步进电机 (42步进) |
| 负载能力 | 最大 800g |

#### 2.3.2 云台控制架构

```
┌─────────────────────────────────────────────────────────────────┐
│                       云台控制系统                               │
└─────────────────────────────────────────────────────────────────┘

         ┌──────────────────────────────────────────────┐
         │              主控 (RK3588)                   │
         │                                              │
         │  ┌────────────────────────────────────────┐ │
         │  │        Face Tracking Algorithm         │ │
         │  │                                        │ │
         │  │  Input: Face Bbox (x, y, w, h)        │ │
         │  │  Output: Target Angle (pitch, yaw)    │ │
         │  │                                        │ │
         │  │  Algorithm: PID + Kalman Filter       │ │
         │  │                                        │ │
         │  └───────────────────┬────────────────────┘ │
         │                      │                      │
         └──────────────────────┼──────────────────────┘
                                │ UART / I2C
                                ▼
         ┌──────────────────────────────────────────────┐
         │           云台控制 MCU (STM32G4)            │
         │                                              │
         │  ┌─────────────┐     ┌─────────────┐       │
         │  │ Step Motor  │     │ Step Motor  │       │
         │  │ Driver      │     │ Driver      │       │
         │  │ (TMC2209)   │     │ (TMC2209)   │       │
         │  └──────┬──────┘     └──────┬──────┘       │
         │         │                   │               │
         │         ▼                   ▼               │
         │  ┌─────────────┐     ┌─────────────┐       │
         │  │ Pitch Motor │     │  Yaw Motor  │       │
         │  │ (42 步进)   │     │  (42 步进)  │       │
         │  └──────┬──────┘     └──────┬──────┘       │
         │         │                   │               │
         │         ▼                   ▼               │
         │  ┌─────────────┐     ┌─────────────┐       │
         │  │  Encoder    │     │  Encoder    │       │
         │  │ (AS5048A)   │     │ (AS5048A)   │       │
         │  └─────────────┘     └─────────────┘       │
         │                                              │
         └──────────────────────────────────────────────┘
```

#### 2.3.3 追踪算法

```python
# 伪代码: 人脸追踪 PID 控制
class FaceTrackingController:
    def __init__(self):
        self.pid_pitch = PIDController(Kp=0.5, Ki=0.1, Kd=0.05)
        self.pid_yaw = PIDController(Kp=0.5, Ki=0.1, Kd=0.05)
        self.kalman = KalmanFilter2D()

    def update(self, face_bbox, frame_size):
        # 计算人脸中心
        face_center = (
            face_bbox.x + face_bbox.w / 2,
            face_bbox.y + face_bbox.h / 2
        )

        # 卡尔曼滤波平滑
        smoothed_center = self.kalman.update(face_center)

        # 计算与画面中心的偏差
        frame_center = (frame_size[0] / 2, frame_size[1] / 2)
        error_x = smoothed_center[0] - frame_center[0]
        error_y = smoothed_center[1] - frame_center[1]

        # PID 计算目标角度
        target_yaw = self.pid_yaw.compute(error_x)
        target_pitch = self.pid_pitch.compute(error_y)

        return target_pitch, target_yaw
```

### 2.4 补光系统

#### 2.4.1 LED 环形灯规格

| 参数 | 规格 |
|------|------|
| LED 数量 | 120颗 (60暖白 + 60冷白) |
| 功率 | 最大 15W |
| 色温范围 | 2700K - 6500K (可调) |
| 显色指数 | CRI > 95 |
| 亮度等级 | 10级可调 |
| 调光方式 | PWM 调光 |
| 特殊模式 | 日光/钨丝灯/荧光灯模拟 |

#### 2.4.2 补光模式

| 模式 | 色温 | 亮度 | 使用场景 |
|------|------|------|----------|
| 日光 | 5600K | 80% | 日常化妆 |
| 暖光 | 3200K | 70% | 晚宴妆容 |
| 冷光 | 6500K | 90% | 皮肤分析 |
| 办公室 | 4000K | 60% | 办公场景预览 |
| 夜店 | 混合 | 闪烁 | 特殊场景预览 |

#### 2.4.3 红外补光

| 参数 | 规格 |
|------|------|
| LED 类型 | 850nm IR LED x 8 |
| 功率 | 2W |
| 用途 | 配合 IR 摄像头进行皮下检测 |
| 安全 | 符合 IEC 62471 标准 |

### 2.5 显示屏

#### 2.5.1 屏幕规格

| 参数 | 规格 |
|------|------|
| 尺寸 | 15.6 英寸 |
| 分辨率 | 1920 x 1080 (Full HD) |
| 面板类型 | IPS |
| 亮度 | 400 nits |
| 对比度 | 1000:1 |
| 色域 | sRGB 100% |
| 触控 | 10点电容触控 |
| 特殊镀膜 | 半透半反镜面镀膜 |
| 接口 | MIPI DSI 4Lane |

#### 2.5.2 镜面效果

```
光线路径:

    用户 ◄─────────────────────────────── 环境光反射 (镜面效果)
      │                                         │
      │                                         │
      ▼                                         │
┌─────────────────────────────────────────────────────────┐
│                   半透半反镀膜                          │ ← 反射 50%
├─────────────────────────────────────────────────────────┤
│                    IPS 面板                             │ ← 透射 50%
├─────────────────────────────────────────────────────────┤
│                    背光模组                             │
└─────────────────────────────────────────────────────────┘

效果:
- 屏幕关闭时: 完整镜面效果
- 屏幕开启时: 镜面 + UI 叠加显示
```

### 2.6 音频系统

| 组件 | 规格 |
|------|------|
| 麦克风 | 2x MEMS 麦克风 (波束成形) |
| 扬声器 | 2x 3W 全频扬声器 |
| 功放 | TI TAS2563 (Class-D) |
| 降噪 | 软件 AI 降噪 |

### 2.7 连接模块

| 接口 | 规格 |
|------|------|
| WiFi | WiFi 6 (802.11ax) 2x2 MIMO |
| 蓝牙 | Bluetooth 5.2 + BLE |
| USB | USB-C x 1 (PD 充电 + 数据) |
| USB | USB-A x 1 (扩展设备) |
| 电源 | DC 12V/3A (含适配器) |

---

## 三、电源系统

### 3.1 电源架构

```
┌─────────────────────────────────────────────────────────────────┐
│                        电源系统架构                              │
└─────────────────────────────────────────────────────────────────┘

  DC 12V Input ──┬──► DC-DC (12V to 5V) ──► RK3588 核心板
                 │                        ──► USB 供电
                 │
                 ├──► DC-DC (12V to 3.3V) ──► 传感器/摄像头
                 │                         ──► WiFi/BLE 模块
                 │
                 ├──► LED 驱动 ──► 环形补光灯
                 │
                 └──► 电机驱动 ──► 云台步进电机

总功率预估:
- RK3588: 10W (峰值)
- 显示屏: 8W
- 补光灯: 15W (最大)
- 摄像头: 2W
- 云台电机: 5W (峰值)
- 其他: 3W
─────────────────
总计: ~43W (峰值)
适配器规格: 12V/5A (60W)
```

### 3.2 散热设计

```
┌─────────────────────────────────────────────────────────────────┐
│                        散热系统                                  │
└─────────────────────────────────────────────────────────────────┘

             ┌───────────────────────────────────────┐
             │             顶部散热孔               │
             └───────────────────────────────────────┘
                              ▲
                              │ 热空气上升
                              │
             ┌────────────────┴────────────────┐
             │          铝合金散热片           │
             │          (鳍片设计)             │
             └────────────────┬────────────────┘
                              │
             ┌────────────────┴────────────────┐
             │          导热硅胶垫             │
             └────────────────┬────────────────┘
                              │
             ┌────────────────┴────────────────┐
             │        RK3588 主控芯片          │
             │          (主热源)               │
             └─────────────────────────────────┘

设计目标:
- 芯片结温 < 80°C
- 外壳温度 < 45°C
- 静音设计 (无风扇)
```

---

## 四、物料清单 (BOM)

### 4.1 核心器件

| 器件 | 型号 | 数量 | 单价 (预估) | 备注 |
|------|------|------|-------------|------|
| 主控 SoC | RK3588 | 1 | ¥350 | 含核心板 |
| 主摄像头 | IMX586 模组 | 1 | ¥120 | 48MP |
| IR 摄像头 | OV7251 模组 | 2 | ¥80 | 850nm + 940nm |
| ToF 传感器 | REAL3 | 1 | ¥150 | 深度感知 |
| 显示屏 | 15.6" IPS | 1 | ¥400 | 含触控 |
| 步进电机 | 42步进 | 2 | ¥50 | 云台 |
| 电机驱动 | TMC2209 | 2 | ¥30 | 静音驱动 |
| 云台 MCU | STM32G431 | 1 | ¥25 | 电机控制 |
| WiFi/BLE | RTL8852CE | 1 | ¥45 | WiFi 6 |
| LED 灯珠 | 0.5W LED | 120 | ¥0.5 | 补光灯 |
| LED 驱动 | TLC5940 | 2 | ¥15 | PWM 调光 |
| 音频功放 | TAS2563 | 1 | ¥12 | Class-D |
| 电源模块 | DC-DC | 3 | ¥20 | 多路输出 |

### 4.2 结构件

| 器件 | 材质 | 数量 | 单价 (预估) |
|------|------|------|-------------|
| 外壳 | ABS + 铝合金 | 1套 | ¥150 |
| 云台结构 | 铝合金 CNC | 1套 | ¥80 |
| 底座 | 锌合金 | 1 | ¥60 |
| 散热片 | 铝合金 | 1 | ¥30 |
| 镜面玻璃 | 镀膜玻璃 | 1 | ¥100 |

### 4.3 成本预估

| 类别 | 成本 (预估) |
|------|-------------|
| 电子器件 | ¥1,500 |
| 结构件 | ¥420 |
| 组装人工 | ¥100 |
| 包装物流 | ¥50 |
| **BOM 总成本** | **¥2,070** |
| 目标零售价 | ¥3,999 - ¥4,999 |

---

## 五、接口定义

### 5.1 对外接口

| 接口 | 位置 | 用途 |
|------|------|------|
| DC 12V | 背部 | 电源输入 |
| USB-C | 侧面 | 调试/OTA/充电 |
| USB-A | 侧面 | 外设扩展 |
| 3.5mm | 侧面 | 耳机输出 |
| microSD | 底部 | 存储扩展 |

### 5.2 内部接口

| 接口 | 连接 | 协议 |
|------|------|------|
| MIPI CSI x4 | 摄像头 | CSI-2 |
| MIPI DSI x2 | 显示屏 | DSI |
| I2C x3 | 传感器 | I2C |
| UART x2 | 云台MCU | UART |
| GPIO x16 | LED/按键 | GPIO |
| SPI x1 | 调试 | SPI |

---

## 六、测试规范

### 6.1 功能测试

| 测试项 | 通过标准 |
|--------|----------|
| 人脸检测 | 1m 距离检测率 > 99% |
| 追踪响应 | 延迟 < 100ms |
| 补光均匀度 | 中心与边缘差异 < 20% |
| 触控响应 | 延迟 < 30ms |
| WiFi 连接 | 10m 信号强度 > -60dBm |

### 6.2 可靠性测试

| 测试项 | 标准 |
|--------|------|
| 高温工作 | 40°C 环境连续工作 8h |
| 低温启动 | -10°C 正常启动 |
| 云台寿命 | 10万次转动无异常 |
| 跌落测试 | 50cm 跌落功能正常 |
| ESD 测试 | ±8kV 接触放电 |

### 6.3 安全认证

| 认证 | 状态 |
|------|------|
| CCC | 必须 |
| CE | 出口欧洲 |
| FCC | 出口美国 |
| RoHS | 必须 |

---

*硬件设计遵循: 可靠性、可制造性、成本优化原则*
